<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A TCGA dataset application â€¢ ceRNAnetsim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="A TCGA dataset application">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-84499524-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84499524-2');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ceRNAnetsim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_usage.html">What does ceRNAnetsim do?</a>
    </li>
    <li>
      <a href="../articles/small_sample.html">Small example demonstrating the approach and the method</a>
    </li>
    <li>
      <a href="../articles/convenient_iteration.html">How to calculate proper number of iterations for simulation of the network</a>
    </li>
    <li>
      <a href="../articles/perturbation_sample.html">How to determine most effective node of network in equal conditions</a>
    </li>
    <li>
      <a href="../articles/realexample.html">How does the system do in the presence of interaction factors?</a>
    </li>
    <li>
      <a href="../articles/mirtarbase_example.html">How does the system behave in mirtarbase dataset without interaction factors?</a>
    </li>
    <li>
      <a href="../articles/auxiliary_commands.html">Helper Commands</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/selcenari/ceRNAnetsim">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>A TCGA dataset application</h1>
                        <h4 class="author">Selcen Ari</h4>
            
            <h4 class="date">2019-10-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/selcenari/ceRNAnetsim/blob/master/vignettes/mirtarbase_example.Rmd"><code>vignettes/mirtarbase_example.Rmd</code></a></small>
      <div class="hidden name"><code>mirtarbase_example.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette is about the integration of gene and miRNA pairs and their expression dataset and analysis. The sample dataset in this demonstration, which contains human miRNA:target pairs, was retrieved from <a href="http://mirtarbase.mbc.nctu.edu.tw/php/download.php">miRTarBase</a> website (Release 7.0).</p>
</div>
<div id="mirnatarget-pairs" class="section level2">
<h2 class="hasAnchor">
<a href="#mirnatarget-pairs" class="anchor"></a>miRNA:target pairs</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install.packages("devtools")</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># devtools::install_github("selcenari/ceRNAnetsim")</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ceRNAnetsim)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"mirtarbasegene"</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(mirtarbasegene)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; # A tibble: 6 x 2</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt;   miRNA           Target </span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;  </span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; 1 hsa-miR-20a-5p  HIF1A  </span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; 2 hsa-miR-146a-5p CXCR4  </span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; 3 hsa-miR-122-5p  CYP7A1 </span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt; 4 hsa-miR-222-3p  STAT5A </span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt; 5 hsa-miR-21-5p   RASGRP1</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt; 6 hsa-miR-148a-3p DNMT1</span></span></code></pre></div>
<p><strong>NOTE</strong> if the mirna:target dataset includes miRNA genes as targets, the <code><a href="../reference/priming_graph.html">priming_graph()</a></code> function can fail. Because, the function define to miRNAs and targets without distinguishing between uppercase or lowercase.</p>
</div>
<div id="gene-expression-in-normal-and-tumor-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-expression-in-normal-and-tumor-samples" class="anchor"></a>Gene expression in normal and tumor samples</h2>
<p>The gene and mirna expression counts of patient barcoded with TCGA-E9-A1N5 is retrieved from TCGA via <code>TCGAbiolinks</code> package from <code>Bioconductor</code>. The instructions of retrieving data can be found at <code>TCGAbiolinks</code> manual.</p>
<p>For this step you donâ€™t have to use TCGA data, any other source or package can be utilized.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"TCGA_E9_A1N5_normal"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(TCGA_E9_A1N5_normal)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; # A tibble: 6 x 7</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt;   patient sample barcode definition ensembl_gene_id external_gene_n~</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;           </span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; 1 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000003 TSPAN6          </span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; 2 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000005 TNMD            </span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; 3 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000419 DPM1            </span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; 4 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000457 SCYL3           </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; 5 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000460 C1orf112        </span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; 6 TCGA-E~ TCGA-~ TCGA-E~ Solid Tis~ ENSG00000000938 FGR             </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; # ... with 1 more variable: gene_expression &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"TCGA_E9_A1N5_tumor"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(TCGA_E9_A1N5_tumor)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; # A tibble: 6 x 7</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt;   patient sample barcode definition ensembl_gene_id external_gene_n~</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;chr&gt;           </span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; 1 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000003 TSPAN6          </span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; 2 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000005 TNMD            </span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt; 3 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000419 DPM1            </span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; 4 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000457 SCYL3           </span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; 5 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000460 C1orf112        </span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; 6 TCGA-E~ TCGA-~ TCGA-E~ Primary s~ ENSG00000000938 FGR             </span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; # ... with 1 more variable: gene_expression &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div id="mirna-expression-data" class="section level2">
<h2 class="hasAnchor">
<a href="#mirna-expression-data" class="anchor"></a>miRNA expression data</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"TCGA_E9_A1N5_mirnatumor"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(TCGA_E9_A1N5_mirnatumor)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; # A tibble: 6 x 6</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt;   barcode             mirbase_ID   miRNA      Precusor total_read total_RPM</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt;   &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; 1 TCGA-E9-A1N5-01A-1~ MIMAT0000062 hsa-let-7~ MI00000~      45725  20802.  </span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; 2 TCGA-E9-A1N5-01A-1~ MIMAT0004481 hsa-let-7~ MI00000~        100     45.5 </span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; 3 TCGA-E9-A1N5-01A-1~ MIMAT0010195 hsa-let-7~ MI00000~          6      2.73</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; 4 TCGA-E9-A1N5-01A-1~ MIMAT0000063 hsa-let-7~ MI00000~      43489  19785.  </span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; 5 TCGA-E9-A1N5-01A-1~ MIMAT0004482 hsa-let-7~ MI00000~        126     57.3 </span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; 6 TCGA-E9-A1N5-01A-1~ MIMAT0000064 hsa-let-7~ MI00000~       2002    911.</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"TCGA_E9_A1N5_mirnanormal"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(TCGA_E9_A1N5_mirnanormal)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; # A tibble: 6 x 6</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;   barcode             mirbase_ID   miRNA      Precusor total_read total_RPM</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;   &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; 1 TCGA-E9-A1N5-11A-4~ MIMAT0000062 hsa-let-7~ MI00000~      67599   37068. </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; 2 TCGA-E9-A1N5-11A-4~ MIMAT0004481 hsa-let-7~ MI00000~        132      72.4</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; 3 TCGA-E9-A1N5-11A-4~ MIMAT0010195 hsa-let-7~ MI00000~         57      31.3</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; 4 TCGA-E9-A1N5-11A-4~ MIMAT0000063 hsa-let-7~ MI00000~      47266   25918. </span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; 5 TCGA-E9-A1N5-11A-4~ MIMAT0004482 hsa-let-7~ MI00000~        126      69.1</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; 6 TCGA-E9-A1N5-11A-4~ MIMAT0000064 hsa-let-7~ MI00000~      14554    7981.</span></span></code></pre></div>
<p>Hereâ€™s the summary of size of each dataset</p>
<table class="table">
<thead><tr class="header">
<th>Dataset name</th>
<th>Number of rows</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>mirtarbasegene</code></td>
<td>380627</td>
</tr>
<tr class="even">
<td><code>TCGA_E9_A1N5_normal</code></td>
<td>56830</td>
</tr>
<tr class="odd">
<td><code>TCGA_E9_A1N5_tumor</code></td>
<td>56830</td>
</tr>
<tr class="even">
<td><code>TCGA_E9_A1N5_mirnanormal</code></td>
<td>750</td>
</tr>
<tr class="odd">
<td><code>TCGA_E9_A1N5_mirnatumor</code></td>
<td>648</td>
</tr>
</tbody>
</table>
</div>
<div id="integrating-data" class="section level2">
<h2 class="hasAnchor">
<a href="#integrating-data" class="anchor"></a>Integrating data</h2>
<p>All of these datasets are integrated using the code below resulting in miRNA:target dataset that contains miRNA and gene expression values.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>TCGA_E9_A1N5_mirnanormal <span class="op">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">inner_join</span>(mirtarbasegene, <span class="dt">by=</span> <span class="st">"miRNA"</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">inner_join</span>(TCGA_E9_A1N5_normal, </span>
<span id="cb6-4"><a href="#cb6-4"></a>             <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Target"</span>=<span class="st"> "external_gene_name"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">  </span><span class="kw">select</span>(Target, miRNA, total_read, gene_expression) <span class="op">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="st">  </span><span class="kw">distinct</span>() -&gt;<span class="st"> </span>TCGA_E9_A1N5_mirnagene</span></code></pre></div>
<pre><code>#&gt; # A tibble: 26 x 3
#&gt; # Groups:   Target, miRNA [26]
#&gt;    Target  miRNA               n
#&gt;    &lt;chr&gt;   &lt;chr&gt;           &lt;int&gt;
#&gt;  1 COG8    hsa-miR-186-5p      2
#&gt;  2 GOLGA8M hsa-miR-1270        2
#&gt;  3 GOLGA8M hsa-miR-5703        2
#&gt;  4 MATR3   hsa-let-7e-5p       2
#&gt;  5 MATR3   hsa-miR-1-3p        2
#&gt;  6 MATR3   hsa-miR-10b-3p      2
#&gt;  7 MATR3   hsa-miR-125b-5p     2
#&gt;  8 MATR3   hsa-miR-149-5p      2
#&gt;  9 MATR3   hsa-miR-155-5p      2
#&gt; 10 MATR3   hsa-miR-16-1-3p     2
#&gt; # ... with 16 more rows</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(TCGA_E9_A1N5_mirnagene)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; # A tibble: 6 x 4</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt;   Target  miRNA         total_read gene_expression</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;              &lt;int&gt;           &lt;dbl&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; 1 CDK6    hsa-let-7a-5p      67599            4669</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; 2 MYC     hsa-let-7a-5p      67599           11593</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; 3 BCL2    hsa-let-7a-5p      67599            2445</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; 4 NKIRAS2 hsa-let-7a-5p      67599            1519</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; 5 ITGB3   hsa-let-7a-5p      67599             196</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; 6 NF2     hsa-let-7a-5p      67599            1755</span></span></code></pre></div>
<p>When we compared the two gene expression dataset of TCGA-E9A1N5 patient, and selected a gene which has 30-fold increased expression, (gene name: HIST1H3H), this gene node will be used in the example. Note that the selected node must not be isolated one. If the an isolated node is selected the change in expression will not propagate in network. (You can see commands for node selection in the vignette <a href="https://selcenari.github.io/ceRNAnetsim/articles/auxiliary_commands.html">The auxiliary commands which can help to the users</a>)</p>
<p>Optionally, you can filter the low expressed gene nodes because they are not effective elements.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>TCGA_E9_A1N5_mirnagene<span class="op">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(gene_expression <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)-&gt;TCGA_E9_A1N5_mirnagene</span></code></pre></div>
<p>The analysis is performed based on amounts of miRNAs and targets as seen. Firstly, we tried to find optimal iteration for the network when simulation start with <em>HIST1H3H</em> node.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a>TCGA_E9_A1N5_mirnagene <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, </span>
<span id="cb10-4"><a href="#cb10-4"></a>                <span class="dt">miRNA_count =</span> total_read) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="st">  </span><span class="kw"><a href="../reference/update_how.html">update_how</a></span>(<span class="dt">node_name =</span> <span class="st">"HIST1H3H"</span>, <span class="dt">how =</span><span class="dv">30</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="st">  </span><span class="kw"><a href="../reference/simulate.html">simulate</a></span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="st">  </span><span class="kw"><a href="../reference/find_iteration.html">find_iteration</a></span>(<span class="dt">plot=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure">
<img src="gifs/HIST13H_iter.png#center" alt=""><p class="caption">Perturbation of HIST1H3H gene on each iteration</p>
</div>
<p>The graph was shown that the change in expression level of HIST1H3H results in weak perturbation efficiency, despite 30-fold change. The code shown below can be used for calculation of fold changes after simulation HIST1H3H gene to 30 fold:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>TCGA_E9_A1N5_mirnagene <span class="op">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, </span>
<span id="cb11-3"><a href="#cb11-3"></a>                <span class="dt">miRNA_count =</span> total_read) <span class="op">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="st">  </span><span class="kw"><a href="../reference/update_how.html">update_how</a></span>(<span class="st">"HIST1H3H"</span>, <span class="dv">30</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">  </span><span class="kw"><a href="../reference/simulate.html">simulate</a></span>(<span class="dv">20</span>)<span class="op">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="st">  </span><span class="kw">as_tibble</span>()<span class="op">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">FC=</span> count_current<span class="op">/</span>initial_count)<span class="op">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(FC))</span></code></pre></div>
<p>Also, perturbation calculation (specifies efficiency of selected node) of HIST1H3H gene</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>TCGA_E9_A1N5_mirnagene <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, </span>
<span id="cb12-3"><a href="#cb12-3"></a>                <span class="dt">miRNA_count =</span> total_read)<span class="op">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="st">  </span><span class="kw"><a href="../reference/calc_perturbation.html">calc_perturbation</a></span>(<span class="dt">node_name=</span> <span class="st">"HIST1H3H"</span>, <span class="dt">cycle=</span><span class="dv">20</span>, <span class="dt">how=</span> <span class="dv">30</span>,<span class="dt">limit =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th><em>perturbation_efficiency</em></th>
<th><em>perturbed_count</em></th>
</tr></thead>
<tbody><tr class="odd">
<td>4.930245e-06</td>
<td>0</td>
</tr></tbody>
</table>
<p>And then, we tried to simulate the network with the gene which has higher expression value. For this, we selected <em>ACTB</em> node as shown in <a href="https://selcenari.github.io/ceRNAnetsim/articles/auxiliary_commands.html">The auxiliary commands which can help to the users</a></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>TCGA_E9_A1N5_mirnagene <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, </span>
<span id="cb13-3"><a href="#cb13-3"></a>                <span class="dt">miRNA_count =</span> total_read) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="st">  </span><span class="kw"><a href="../reference/update_how.html">update_how</a></span>(<span class="dt">node_name =</span> <span class="st">"ACTB"</span>, <span class="dt">how =</span><span class="fl">1.87</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="st">  </span><span class="kw"><a href="../reference/simulate.html">simulate</a></span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="st">  </span><span class="kw"><a href="../reference/find_iteration.html">find_iteration</a></span>(<span class="dt">plot=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure">
<img src="gifs/ACTB_iter.png#center" alt=""><p class="caption">Perturbation of ACTB gene on each iteration</p>
</div>
<p>Following codes are shown entire gene fold changes after simulation ACTB gene to 1.87 fold:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>TCGA_E9_A1N5_mirnagene <span class="op">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, </span>
<span id="cb14-3"><a href="#cb14-3"></a>                <span class="dt">miRNA_count =</span> total_read) <span class="op">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="st">  </span><span class="kw"><a href="../reference/update_how.html">update_how</a></span>(<span class="st">"ACTB"</span>, <span class="fl">1.87</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">  </span><span class="kw"><a href="../reference/simulate.html">simulate</a></span>(<span class="dv">20</span>)<span class="op">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="st">  </span><span class="kw">as_tibble</span>()<span class="op">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">FC=</span> count_current<span class="op">/</span>initial_count)<span class="op">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(FC))</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>TCGA_E9_A1N5_mirnagene <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, </span>
<span id="cb15-3"><a href="#cb15-3"></a>                <span class="dt">miRNA_count =</span> total_read)<span class="op">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="st">  </span><span class="kw"><a href="../reference/calc_perturbation.html">calc_perturbation</a></span>(<span class="dt">node_name=</span> <span class="st">"ACTB"</span>, <span class="dt">cycle=</span><span class="dv">20</span>, <span class="dt">how=</span> <span class="fl">1.87</span>,<span class="dt">limit =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th><em>perturbation_efficiency</em></th>
<th><em>perturbed_count</em></th>
</tr></thead>
<tbody><tr class="odd">
<td>0.01548928</td>
<td>826</td>
</tr></tbody>
</table>
<p>On the other hand, the perturbation eficiency of ATCB gene is higher, when this gene is regulated with 30-fold upregulation like in HIST1H3H.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>TCGA_E9_A1N5_mirnagene <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">  </span><span class="kw"><a href="../reference/priming_graph.html">priming_graph</a></span>(<span class="dt">competing_count =</span> gene_expression, </span>
<span id="cb16-3"><a href="#cb16-3"></a>                <span class="dt">miRNA_count =</span> total_read)<span class="op">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="st">  </span><span class="kw"><a href="../reference/calc_perturbation.html">calc_perturbation</a></span>(<span class="dt">node_name=</span> <span class="st">"ACTB"</span>, <span class="dt">cycle=</span><span class="dv">20</span>, <span class="dt">how=</span> <span class="dv">30</span>,<span class="dt">limit =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th><em>perturbation_efficiency</em></th>
<th><em>perturbed_count</em></th>
</tr></thead>
<tbody><tr class="odd">
<td>0.2094567</td>
<td>3712</td>
</tr></tbody>
</table>
</div>
<div id="the-sum-of-two-conditions" class="section level2">
<h2 class="hasAnchor">
<a href="#the-sum-of-two-conditions" class="anchor"></a>The sum of two conditions:</h2>
<p>In a real biological sample, we tested perturbation efficiencies of two genes; * one with low expression but high fold change (HIST1H3H, 30-fold increase in tumor) * another one with high expression but small change in expression level (ACTB, 1.87-fold increase in tumor)</p>
<p>With these two samples, it has been obtained that expression values of genes, rest of the perturbed gene, changed slightly.</p>
<p>Despite high fold change, former gene caused little perturbation. When the perturbation efficiencies of both of these genes are analysed, it has been oberved that HIST1H3H does not affect the other genes in given limit. On the contrary, high expressing gene with very low fold increase in tumor causes greater perturbation in the network. Additionaly, the perturbation efficiency of ACTB gene is quite high from HIST1H3H with 30-fold change, when ACTB is simulated with 30 fold-change.</p>
<p>Thus, if the perturbed node has lower target:total target ratio in group or groups, the efficiency of it can be weak, or vice versa. The efficiency of ACTB gene may be high for this reason, in comparison with HIST1H3H perturbation. In fact, it has been observed that ACTB has not strong perturbation efficiency too. This could be arisen from low miRNA:target ratio or ineffective target nodes which have very low expression levels.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#mirnatarget-pairs">miRNA:target pairs</a></li>
      <li><a href="#gene-expression-in-normal-and-tumor-samples">Gene expression in normal and tumor samples</a></li>
      <li><a href="#mirna-expression-data">miRNA expression data</a></li>
      <li><a href="#integrating-data">Integrating data</a></li>
      <li><a href="#the-sum-of-two-conditions">The sum of two conditions:</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Selcen Ari Yuka, Alper Yilmaz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'fbd8d79ed49f21fc9ca7b2cf601a3f5b',
    indexName: 'ceRNAnetsim',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
